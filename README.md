# The DoH-DGA-Malware-Traffic-HKD dataset

* The dataset (DoH-DGA-Malware-Traffic-HKD.zip) is available on the Hokkaido University website - https://eprints.lib.hokudai.ac.jp/dspace/handle/2115/86574.

* The dataset contains PCAP files of DoH traffic flows generated by PadCrypt [1], Sisron [2], Tinba [3], and Zloader [4].

* The dataset also includes CSV files of statistical traffic features extracted from PCAP files by DoHlyzer [5].

* The "l3-malware.csv" encloses traffic flows of PadCrypt 840, Sisron 744, Tinba 1808, and Zloader 820.

# License

* If you use the dataset, please be sure to cite the following paper.

* Rikima Mitsuhashi, Yong Jin, Katsuyoshi Iida, Takahiro Shinagawa, and Yoshiaki Takai, 
"Detection of DGA-based Malware Communications from DoH Traffic Using Machine Learning Analysis,"
*2023 IEEE 20th Consumer Communications & Networking Conference (CCNC)*, 2023. https://ieeexplore.ieee.org/document/10059835.

# Network connections and capture point

![network](https://user-images.githubusercontent.com/56641139/206830229-5b9e5262-66d2-42d9-9974-1b9a6b0efd6d.png)

* The DGA-based malware connects to the DoH server through the operting system supporting DoH for domain name resolution.

* To keep network envirionment safe, the DoH server returns NXDOMAIN messages to DGA-based malware so that DGA-based
  malware cannot connect to the Command and Control (C&C) server.

# Malware instances - SHA256 hash

* Malware instances are in VirusShare.com [6]
* f0f8ef9a0cd40363aa4b06ba4c0fa286f23010830caa931addefacb087d7c678 <B>- PadCrypt</B>
* c80b5846fe82d218f496db519d6cfe7b9d7625dd2e00b044850208d28a7eee94 <B>- Sisron</B> 
* b91cea891a4188907bf3ab9e5babf5e5821ad475f24ccc1bc6b68a0d66914ced <B>- Tinba</B> 
* 835048e00ba3babf6f920c9a4c2863865a5dcf8e0b6ede4f57c63aeb9cb5c147 <B>- Zloader</B>  

# Appendix

* The CIRA-CIC-DoHBrw-2020 and DoH-DGA-Malware-Traffic-HKD combined dataset is available on the website - https://github.com/rikima-mitsuhashi/CIRA-CIC-DoHBrw-2020-and-DoH-DGA-Malware-Traffic-HKD/.

# References
* [1] PadCrypt  (https://bin.re/blog/the-dga-of-padcrypt/)
* [2] Sisron (https://bin.re/blog/the-dga-of-sisron/)
* [3] Tinba (https://bin.re/blog/new-top-level-domains-for-tinbas-dga/)
* [4] Zloader (https://bin.re/blog/the-dga-of-zloader/)
* [5] DoHlyzer (https://github.com/ahlashkari/DoHlyzer)
* [6] VirusShare.com (https://virusshare.com/)


